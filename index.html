<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welfare First - EROAD Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            background: #f5f7fa;
            min-height: 100vh;
            padding: 40px 20px;
            color: #2c3e50;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            margin-bottom: 30px;
            border-left: 4px solid #3498db;
        }

        .header h1 {
            color: #2c3e50;
            font-size: 2.2em;
            margin-bottom: 8px;
            font-weight: 600;
            letter-spacing: -0.5px;
        }

        .header p {
            color: #7f8c8d;
            font-size: 1em;
            font-weight: 400;
        }

        .date-period {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #ecf0f1;
            color: #95a5a6;
            font-size: 0.9em;
        }

        .filters-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            margin-bottom: 30px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
        }

        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .insight-card {
            background: white;
            padding: 28px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            border-left: 3px solid #ecf0f1;
            transition: all 0.2s ease;
        }

        .insight-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transform: translateY(-2px);
        }

        .insight-card.danger {
            border-left-color: #e74c3c;
        }

        .insight-card.warning {
            border-left-color: #f39c12;
        }

        .insight-card.success {
            border-left-color: #27ae60;
        }

        .insight-card.info {
            border-left-color: #3498db;
        }

        .insight-label {
            color: #95a5a6;
            font-size: 0.75em;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .insight-value {
            color: #2c3e50;
            font-size: 2.5em;
            font-weight: 700;
            margin-bottom: 8px;
            line-height: 1;
        }

        .insight-description {
            color: #7f8c8d;
            font-size: 0.9em;
            font-weight: 400;
        }

        .controls {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            margin-bottom: 30px;
            display: none; /* Hidden as we'll use filters-container instead */
        }

        .controls label {
            display: block;
            color: #2c3e50;
            font-weight: 600;
            margin-bottom: 12px;
            font-size: 0.95em;
            letter-spacing: 0.3px;
        }

        .filter-group label {
            display: block;
            color: #2c3e50;
            font-weight: 600;
            margin-bottom: 12px;
            font-size: 0.95em;
            letter-spacing: 0.3px;
        }

        .controls select {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #ecf0f1;
            border-radius: 8px;
            font-size: 0.95em;
            color: #2c3e50;
            background: white;
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: inherit;
        }

        .controls select:hover {
            border-color: #bdc3c7;
        }

        .controls select:focus {
            outline: none;
            border-color: #3498db;
        }

        .filter-group select {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #ecf0f1;
            border-radius: 8px;
            font-size: 0.95em;
            color: #2c3e50;
            background: white;
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: inherit;
        }

        .filter-group select:hover {
            border-color: #bdc3c7;
        }

        .filter-group select:focus {
            outline: none;
            border-color: #3498db;
        }

        .chart-container {
            background: white;
            padding: 35px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            margin-bottom: 30px;
        }

        .chart-title {
            color: #2c3e50;
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #ecf0f1;
            letter-spacing: -0.3px;
        }

        canvas {
            max-height: 400px;
        }

        .summary-table {
            background: white;
            padding: 35px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            background: #34495e;
            color: white;
            padding: 16px 20px;
            text-align: left;
            font-weight: 600;
            font-size: 0.85em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        td {
            padding: 18px 20px;
            border-bottom: 1px solid #ecf0f1;
            color: #2c3e50;
            font-size: 0.95em;
        }

        tr:last-child td {
            border-bottom: none;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .badge {
            display: inline-block;
            padding: 6px 14px;
            border-radius: 6px;
            font-size: 0.85em;
            font-weight: 600;
            letter-spacing: 0.3px;
        }

        .badge.sla-met {
            background: #27ae60;
            color: white;
        }

        .badge.sla-target {
            background: #f39c12;
            color: white;
        }

        .badge.sla-breach {
            background: #e74c3c;
            color: white;
        }

        @media (max-width: 768px) {
            body {
                padding: 20px 15px;
            }

            .header {
                padding: 30px 25px;
            }

            .header h1 {
                font-size: 1.8em;
            }
            
            .insights-grid {
                grid-template-columns: 1fr;
            }

            .chart-container, .summary-table {
                padding: 25px 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Welfare First - EROAD Dashboard</h1>
            <p>Customer Alert Response Time Analytics</p>
            <div class="date-period" id="datePeriod">Data Period: December 2024 - October 2025</div>
        </div>

        <div class="insights-grid" id="insightsGrid"></div>

        <div class="filters-container">
            <div class="filter-group">
                <label for="customerSelect">Select Customer</label>
                <select id="customerSelect" onchange="updateDashboard()">
                    <option value="All">All Customers</option>
                </select>
            </div>
            <div class="filter-group">
                <label for="monthSelect">Select Month</label>
                <select id="monthSelect" onchange="updateDashboard()">
                    <option value="All">All Months</option>
                </select>
            </div>
        </div>

        <div class="chart-container">
            <h2 class="chart-title">Alerts vs Response Time</h2>
            <canvas id="combinedChart"></canvas>
        </div>

        <div class="chart-container">
            <h2 class="chart-title">Response Time Trend</h2>
            <canvas id="responseChart"></canvas>
        </div>

        <div class="chart-container">
            <h2 class="chart-title">Alert Volume by Month</h2>
            <canvas id="alertChart"></canvas>
        </div>

        <div class="summary-table" id="summaryTable"></div>
    </div>

    <script>
        const data = {
            'Booths Logistics': [
                { month: 'Dec 2024', alerts: 1, avgResponse: 25 },
                { month: 'Feb 2025', alerts: 11, avgResponse: 10 },
                { month: 'Mar 2025', alerts: 18, avgResponse: 111 },
                { month: 'Apr 2025', alerts: 12, avgResponse: 13 },
                { month: 'May 2025', alerts: 10, avgResponse: 158 },
                { month: 'Jun 2025', alerts: 18, avgResponse: 12 },
                { month: 'Jul 2025', alerts: 40, avgResponse: 26 },
                { month: 'Aug 2025', alerts: 67, avgResponse: 21 },
                { month: 'Sept 2025', alerts: 77, avgResponse: 24 },
                { month: 'Oct 2025', alerts: 43, avgResponse: 18 }
            ],
            'Cleanaway': [
                { month: 'Mar 2025', alerts: 12, avgResponse: 20 },
                { month: 'Apr 2025', alerts: 12, avgResponse: 7 },
                { month: 'May 2025', alerts: 16, avgResponse: 31 },
                { month: 'Jun 2025', alerts: 23, avgResponse: 15 },
                { month: 'Jul 2025', alerts: 23, avgResponse: 9 },
                { month: 'Aug 2025', alerts: 18, avgResponse: 7 },
                { month: 'Sept 2025', alerts: 3, avgResponse: 5 }
            ],
            'D & S Freighters Limited': [
                { month: 'May 2025', alerts: 2, avgResponse: 103 }
            ],
            'Fulton Hogan Limited': [
                { month: 'Jul 2025', alerts: 33, avgResponse: 13 },
                { month: 'Aug 2025', alerts: 13, avgResponse: 8 }
            ],
            'JJ Tranz Limited': [
                { month: 'Jun 2025', alerts: 4, avgResponse: 9 },
                { month: 'Jul 2025', alerts: 3, avgResponse: 18 },
                { month: 'Sept 2025', alerts: 1, avgResponse: 8 }
            ],
            'MJ Mahon Holdings (Australia)': [
                { month: 'Jun 2025', alerts: 3, avgResponse: 12 },
                { month: 'Aug 2025', alerts: 2, avgResponse: 6 }
            ],
            'Wessels Express Limited': [
                { month: 'Jun 2025', alerts: 12, avgResponse: 20 },
                { month: 'Jul 2025', alerts: 6, avgResponse: 38 }
            ]
        };

        const allMonths = ['Dec 2024', 'Feb 2025', 'Mar 2025', 'Apr 2025', 'May 2025', 'Jun 2025', 'Jul 2025', 'Aug 2025', 'Sept 2025', 'Oct 2025'];

        let charts = {};

        function getSLAStatus(avgResponse) {
            if (avgResponse <= 60) {
                return { status: 'SLA Met (90%)', class: 'sla-met', target: '≤60s' };
            } else if (avgResponse <= 120) {
                return { status: 'SLA Target (98%)', class: 'sla-target', target: '≤120s' };
            } else if (avgResponse <= 180) {
                return { status: 'SLA Limit (100%)', class: 'sla-target', target: '≤180s' };
            } else {
                return { status: 'SLA Breach', class: 'sla-breach', target: '>180s' };
            }
        }

        function getCombinedData(selectedMonth = 'All') {
            let monthsToShow = selectedMonth === 'All' ? allMonths : [selectedMonth];
            
            return monthsToShow.map(month => {
                const monthData = { month };
                let totalAlerts = 0;
                let totalWeightedResponse = 0;
                
                Object.keys(data).forEach(customer => {
                    const customerMonth = data[customer].find(d => d.month === month);
                    if (customerMonth) {
                        totalAlerts += customerMonth.alerts;
                        totalWeightedResponse += customerMonth.avgResponse * customerMonth.alerts;
                    }
                });
                
                monthData.alerts = totalAlerts;
                monthData.avgResponse = totalAlerts > 0 ? Math.round(totalWeightedResponse / totalAlerts) : null;
                
                return monthData;
            }).filter(d => d.alerts > 0);
        }

        function getCustomerSummary(selectedMonth = 'All') {
            return Object.keys(data).map(customer => {
                let customerData = data[customer];
                
                // Filter by month if specific month selected
                if (selectedMonth !== 'All') {
                    customerData = customerData.filter(d => d.month === selectedMonth);
                }
                
                if (customerData.length === 0) return null;
                
                const totalAlerts = customerData.reduce((sum, d) => sum + d.alerts, 0);
                const avgResponse = Math.round(
                    customerData.reduce((sum, d) => sum + d.avgResponse * d.alerts, 0) / totalAlerts
                );
                const sla = getSLAStatus(avgResponse);
                
                return {
                    name: customer,
                    totalAlerts: totalAlerts,
                    avgResponse: avgResponse,
                    slaStatus: sla.status,
                    slaClass: sla.class,
                    slaTarget: sla.target
                };
            }).filter(c => c !== null).sort((a, b) => b.totalAlerts - a.totalAlerts);
        }

        function calculateInsights(selectedCustomer, selectedMonth = 'All') {
            let customerData;
            if (selectedCustomer === 'All') {
                customerData = getCombinedData(selectedMonth);
            } else {
                customerData = data[selectedCustomer];
                if (selectedMonth !== 'All') {
                    customerData = customerData.filter(d => d.month === selectedMonth);
                }
            }

            if (customerData.length === 0) {
                return { totalAlerts: 0, avgResponse: 0, slaInfo: getSLAStatus(0), maxResponse: 0, minResponse: 0, peakMonth: { alerts: 0, month: 'N/A' } };
            }

            const totalAlerts = customerData.reduce((sum, d) => sum + d.alerts, 0);
            const avgResponse = Math.round(
                customerData.reduce((sum, d) => sum + d.avgResponse * d.alerts, 0) / totalAlerts
            );
            const slaInfo = getSLAStatus(avgResponse);
            const maxResponse = Math.max(...customerData.map(d => d.avgResponse));
            const minResponse = Math.min(...customerData.map(d => d.avgResponse));
            const peakMonth = customerData.reduce((max, d) => d.alerts > max.alerts ? d : max);

            return { totalAlerts, avgResponse, slaInfo, maxResponse, minResponse, peakMonth };
        }

        function renderInsights(insights) {
            const insightsGrid = document.getElementById('insightsGrid');
            insightsGrid.innerHTML = `
                <div class="insight-card info">
                    <div class="insight-label">Total Alerts</div>
                    <div class="insight-value">${insights.totalAlerts}</div>
                    <div class="insight-description">Across all periods</div>
                </div>
                <div class="insight-card ${insights.slaInfo.class === 'sla-met' ? 'success' : insights.slaInfo.class === 'sla-breach' ? 'danger' : 'warning'}">
                    <div class="insight-label">Average Response</div>
                    <div class="insight-value">${insights.avgResponse}s</div>
                    <div class="insight-description">${insights.slaInfo.status}</div>
                </div>
                <div class="insight-card danger">
                    <div class="insight-label">Slowest Response</div>
                    <div class="insight-value">${insights.maxResponse}s</div>
                    <div class="insight-description">Maximum recorded</div>
                </div>
                <div class="insight-card success">
                    <div class="insight-label">Fastest Response</div>
                    <div class="insight-value">${insights.minResponse}s</div>
                    <div class="insight-description">Minimum recorded</div>
                </div>
                <div class="insight-card warning">
                    <div class="insight-label">Peak Activity</div>
                    <div class="insight-value">${insights.peakMonth.alerts}</div>
                    <div class="insight-description">${insights.peakMonth.month}</div>
                </div>
            `;
        }

        function renderSummaryTable(selectedMonth = 'All') {
            const summary = getCustomerSummary(selectedMonth);
            const summaryTable = document.getElementById('summaryTable');
            
            if (summary.length === 0) {
                summaryTable.innerHTML = `
                    <h2 class="chart-title">Customer Summary</h2>
                    <p style="padding: 20px; color: #7f8c8d;">No data available for the selected period.</p>
                `;
                return;
            }
            
            summaryTable.innerHTML = `
                <h2 class="chart-title">Customer Summary</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Customer</th>
                            <th>Total Alerts</th>
                            <th>Avg Response</th>
                            <th>SLA Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${summary.map(customer => `
                            <tr>
                                <td><strong>${customer.name}</strong></td>
                                <td>${customer.totalAlerts}</td>
                                <td>${customer.avgResponse}s</td>
                                <td>
                                    <span class="badge ${customer.slaClass}">
                                        ${customer.slaStatus}
                                    </span>
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
                <div style="margin-top: 25px; padding: 20px; background: #ecf0f1; border-radius: 8px; font-size: 0.9em; color: #2c3e50;">
                    <strong>SLA Targets:</strong><br>
                    • 90% of alerts resolved within 60 seconds<br>
                    • 98% of alerts resolved within 120 seconds<br>
                    • 100% of alerts resolved within 180 seconds
                </div>
            `;
        }

        function updateDashboard() {
            const selectedCustomer = document.getElementById('customerSelect').value;
            const selectedMonth = document.getElementById('monthSelect').value;
            
            let displayData;
            if (selectedCustomer === 'All') {
                displayData = getCombinedData(selectedMonth);
            } else {
                displayData = data[selectedCustomer];
                if (selectedMonth !== 'All') {
                    displayData = displayData.filter(d => d.month === selectedMonth);
                }
            }
            
            // Update date period display
            const datePeriod = document.getElementById('datePeriod');
            if (selectedMonth === 'All') {
                datePeriod.textContent = 'Data Period: December 2024 - October 2025';
            } else {
                datePeriod.textContent = `Data Period: ${selectedMonth}`;
            }
            
            const insights = calculateInsights(selectedCustomer, selectedMonth);
            renderInsights(insights);

            if (displayData.length === 0) {
                // Show empty state for charts
                ['combinedChart', 'responseChart', 'alertChart'].forEach(chartId => {
                    const canvas = document.getElementById(chartId);
                    const ctx = canvas.getContext('2d');
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI"';
                    ctx.fillStyle = '#7f8c8d';
                    ctx.textAlign = 'center';
                    ctx.fillText('No data available for selected filters', canvas.width / 2, canvas.height / 2);
                });
                
                if (selectedCustomer === 'All') {
                    document.getElementById('summaryTable').style.display = 'block';
                    renderSummaryTable(selectedMonth);
                } else {
                    document.getElementById('summaryTable').style.display = 'none';
                }
                return;
            }

            const months = displayData.map(d => d.month);
            const alerts = displayData.map(d => d.alerts);
            const responses = displayData.map(d => d.avgResponse);

            // Combined Chart
            if (charts.combined) charts.combined.destroy();
            charts.combined = new Chart(document.getElementById('combinedChart'), {
                type: 'bar',
                data: {
                    labels: months,
                    datasets: [{
                        label: 'Alerts',
                        data: alerts,
                        backgroundColor: 'rgba(52, 152, 219, 0.8)',
                        borderColor: 'rgba(52, 152, 219, 1)',
                        borderWidth: 1,
                        yAxisID: 'y'
                    }, {
                        label: 'Avg Response (sec)',
                        data: responses,
                        type: 'line',
                        borderColor: 'rgba(231, 76, 60, 1)',
                        backgroundColor: 'rgba(231, 76, 60, 0.1)',
                        borderWidth: 2,
                        tension: 0.3,
                        yAxisID: 'y1'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: {
                            labels: {
                                font: {
                                    family: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto',
                                    size: 12
                                },
                                color: '#2c3e50'
                            }
                        }
                    },
                    scales: {
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: {
                                display: true,
                                text: 'Number of Alerts',
                                color: '#666',
                                font: {
                                    size: 11,
                                    weight: '600'
                                }
                            },
                            ticks: {
                                color: '#7f8c8d'
                            },
                            grid: {
                                color: '#ecf0f1'
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: {
                                display: true,
                                text: 'Avg Response (sec)',
                                color: '#7f8c8d',
                                font: {
                                    size: 11,
                                    weight: '600'
                                }
                            },
                            ticks: {
                                color: '#7f8c8d'
                            },
                            grid: {
                                drawOnChartArea: false,
                            }
                        },
                        x: {
                            ticks: {
                                color: '#7f8c8d'
                            },
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });

            // Response Chart
            if (charts.response) charts.response.destroy();
            charts.response = new Chart(document.getElementById('responseChart'), {
                type: 'line',
                data: {
                    labels: months,
                    datasets: [{
                        label: 'Avg Response Time (sec)',
                        data: responses,
                        borderColor: 'rgba(155, 89, 182, 1)',
                        backgroundColor: 'rgba(155, 89, 182, 0.08)',
                        borderWidth: 2,
                        tension: 0.3,
                        fill: true,
                        pointBackgroundColor: '#9b59b6',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            labels: {
                                font: {
                                    family: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto',
                                    size: 12
                                },
                                color: '#1a1a1a'
                            }
                        }
                    },
                    scales: {
                        y: {
                            ticks: {
                                color: '#666'
                            },
                            grid: {
                                color: '#f0f0f0'
                            }
                        },
                        x: {
                            ticks: {
                                color: '#666'
                            },
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });

            // Alert Chart
            if (charts.alert) charts.alert.destroy();
            charts.alert = new Chart(document.getElementById('alertChart'), {
                type: 'bar',
                data: {
                    labels: months,
                    datasets: [{
                        label: 'Alerts',
                        data: alerts,
                        backgroundColor: 'rgba(230, 126, 34, 0.8)',
                        borderColor: 'rgba(230, 126, 34, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            labels: {
                                font: {
                                    family: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto',
                                    size: 12
                                },
                                color: '#1a1a1a'
                            }
                        }
                    },
                    scales: {
                        y: {
                            ticks: {
                                color: '#666'
                            },
                            grid: {
                                color: '#f0f0f0'
                            }
                        },
                        x: {
                            ticks: {
                                color: '#666'
                            },
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });

            if (selectedCustomer === 'All') {
                document.getElementById('summaryTable').style.display = 'block';
                renderSummaryTable(selectedMonth);
            } else {
                document.getElementById('summaryTable').style.display = 'none';
            }
        }

        // Initialize
        const customerSelect = document.getElementById('customerSelect');
        Object.keys(data).forEach(customer => {
            const option = document.createElement('option');
            option.value = customer;
            option.textContent = customer;
            customerSelect.appendChild(option);
        });

        const monthSelect = document.getElementById('monthSelect');
        allMonths.forEach(month => {
            const option = document.createElement('option');
            option.value = month;
            option.textContent = month;
            monthSelect.appendChild(option);
        });

        updateDashboard();
    </script>
</body>
</html>
